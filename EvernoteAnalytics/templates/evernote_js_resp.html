{% extends "base.html" %}
{{ credentials }}
{% block head %} 
<link rel="stylesheet" href="amanda/gmaps.css" type="text/css" />
<script type="text/javascript" src="{{ STATIC_URL}}amanda/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
{% endblock head %}

{% block bodyOptions %} onload="gmapswindow()"{% endblock bodyOptions %}
{% block body %}
<script type="text/javascript">
   var guidMap = {% autoescape off %} {{ guidMap }} {% endautoescape %}
   
   var dayCount = {% autoescape off %} {{ dayFrequency }} {% endautoescape %}
   google.load("visualization", "1", {packages:["corechart"]});
   google.setOnLoadCallback(drawChart);
   function drawChart() {
      var ret = Array(["Sunday",0],["Monday",0],["Tuesday",0],["Wednesday",0],["Thursday",0],["Friday",0],["Saturday",0]);
      $.each(dayCount, function(i,obj){
         ret[i][1] = obj
      })
      var data = new google.visualization.DataTable();
      data.addColumn('string', 'Day');
      data.addColumn('number', 'Total Notes');
      data.addRows(ret);
      var options = {
          title: '',
          hAxis: {title: 'Days', titleTextStyle: {color: 'purple'}}
      };

      var chart = new google.visualization.ColumnChart(document.getElementById('chart'));
      chart.draw(data, options);
   }
</script>
<div class="container" style="margin-top:20px">
  <div class="row">
     <div class="span12" style="background: #ffffff">
        <h2>Total Posts by Day</h2>
        <div id="chart"></div>
     </div>
  </div>
  <div class="row" style="">
  <div class="span5" style="text-align: center; margin-top: 10%; vertical-align: center">
   <script type="text/javascript" src="https://www.google.com/jsapi"></script>
      <script type="text/javascript">
         google.load("visualization", "1", {packages:["corechart"]});
         google.setOnLoadCallback(drawChart);
         function drawChart() {
           var noteCount = {% autoescape off %} {{ notebookFrequency }} 
                           {% endautoescape %}
           var data = new google.visualization.DataTable();
           var ret = Array();
           $.each(noteCount, function(i,obj){
             ret.push([guidMap[i],obj]);
           })
           data.addColumn('string', 'Notebook');
           data.addColumn('number', 'Numbers of Notes');
           data.addRows(ret);
           var options = {
             title: 'Posts per Notebook'
           };

           var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
           chart.draw(data, options);
         }
      </script>
  <div id="chart_div" style="width: 900px; height: 500px;"></div>
  </div>
  </div>
  <div class="span5" style="text-align: center; margin-left: auto; margin-right: auto;">
   <script type="text/javascript" src="https://www.google.com/jsapi"></script>
      <script type="text/javascript">
         google.load("visualization", "1", {packages:["corechart"]});
         google.setOnLoadCallback(drawChart);
         function drawChart() {
           var noteCount = {% autoescape off %} {{ tagFrequency }} 
                           {% endautoescape %}
           var data = new google.visualization.DataTable();
           var ret = Array();
           $.each(noteCount, function(i,obj){
             ret.push([guidMap[i],obj]);
           })
           data.addColumn('string', 'Tag');
           data.addColumn('number', 'Numbers of Notes');
           data.addRows(ret);
           var options = {
             title: 'Posts per Tag'
           };

           var chart = new google.visualization.PieChart(document.getElementById('chart_div2'));
           chart.draw(data, options);
         }
      </script>
  <div id="chart_div2" style="width: 900px; height: 500px;"></div>
  </div>
  <div class="span12" style="margin-top: 20px">
    <h2> Geotags of posts </h2>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
    <script type="text/javascript">
      function gmapswindow(){
        var points = {% autoescape off %} {{ geoLocations }}
                     {% endautoescape %}
        var center = [42.408, -71.120]
        var landmark = new google.maps.LatLng(center[0],center[1]);
        var myOptions = {
          zoom: 12, // The larger the zoom number, the bigger the zoom
          center: landmark,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        var map = new google.maps.Map(document.getElementById("map_canvas"), 
                                      myOptions);   
        var elephant = '{{ STATIC_URL}}amanda/evernote.jpg';	
        for (i = 0; i<points.length; i++) {
          var land = new google.maps.LatLng(points[i][1],points[i][2]);
          var marker = new google.maps.Marker({
            position: land,
            title: points[i][0],
            icon: elephant
          });
          marker.setMap(map);
          var statwindow = new google.maps.InfoWindow();
          google.maps.event.addListener(marker, 'click', (function(marker, i) {
            return function(){
              statwindow.setContent(points[i][0]);
              statwindow.open(map, marker);
            }
          })(marker,i));
        }
      }
    </script>
    <div id="map_canvas"></div>
    <div id="loc"></div>
    </div></div>
  </div>
</div>
{% endblock body %}
